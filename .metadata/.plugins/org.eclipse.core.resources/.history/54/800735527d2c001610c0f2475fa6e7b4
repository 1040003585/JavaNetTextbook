package _4_3Socket编程示例._4_4_1一对多的通信;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;

/**
 * 
 * Copyright ? 2016 Authors. All rights reserved.
 *
 * FileName: Server.java
 * @author : Wu_Being <1040003585@qq.com>
 * Date/Time: 2016-6-7/下午02:35:45
 * Description: 
 */
public class Server {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub

		System.out.println("S等待连接......");
		try {
			//创建端口号9955的服务器套接字
			ServerSocket serverSocket = new ServerSocket(9955);
			//监听来处客户的连接请求
			Socket socket=serverSocket.accept();
			System.out.println("S连接请求来自："+socket.getInetAddress().getHostAddress());
			//创建数据输入输出流
			DataInputStream dis=new DataInputStream(socket.getInputStream());
			DataOutputStream dos=new DataOutputStream(socket.getOutputStream());
			
			boolean goon=true;
			while(goon){
				//从socket中读取数据
				String string=dis.readUTF();
				if(string.equals("end")==false){
					double radius=Double.parseDouble(string);
					System.out.println("S接收到的半径值为："+radius);	
					double area=radius*radius*Math.PI;
					string=Double.toString(area);
					dos.writeUTF(string);	//向socket写数据
					dos.flush();			//清空缓冲区，立即发送
					System.out.println("S圆的面积"+string+"已经发送");
				}else{
					goon=false;
					dos.writeUTF("end");
					dos.flush();
				}

			}
			
		} catch (IOException e) {
			e.printStackTrace();
		}
	}

}
